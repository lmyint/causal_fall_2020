<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 4 Causal Graphs as Statistical Models | STAT 451: Causal Inference</title>
  <meta name="description" content="This is the class website for Causal Inference at Macalester College." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 4 Causal Graphs as Statistical Models | STAT 451: Causal Inference" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the class website for Causal Inference at Macalester College." />
  <meta name="github-repo" content="lmyint/causal_fall_2020" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 4 Causal Graphs as Statistical Models | STAT 451: Causal Inference" />
  
  <meta name="twitter:description" content="This is the class website for Causal Inference at Macalester College." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="study-designs-overview.html"/>
<link rel="next" href="homework-1.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #2a211c; color: #bdae9d; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; background-color: #2a211c; color: #bdae9d; border-right: 1px solid #bdae9d; }
td.sourceCode { padding-left: 5px; }
pre, code { color: #bdae9d; background-color: #2a211c; }
code > span.kw { color: #43a8ed; font-weight: bold; } /* Keyword */
code > span.dt { text-decoration: underline; } /* DataType */
code > span.dv { color: #44aa43; } /* DecVal */
code > span.bn { color: #44aa43; } /* BaseN */
code > span.fl { color: #44aa43; } /* Float */
code > span.ch { color: #049b0a; } /* Char */
code > span.st { color: #049b0a; } /* String */
code > span.co { color: #0066ff; font-style: italic; } /* Comment */
code > span.al { color: #ffff00; } /* Alert */
code > span.fu { color: #ff9358; font-weight: bold; } /* Function */
code > span.er { color: #ffff00; font-weight: bold; } /* Error */
code > span.wa { color: #ffff00; font-weight: bold; } /* Warning */
code > span.cn { } /* Constant */
code > span.sc { color: #049b0a; } /* SpecialChar */
code > span.vs { color: #049b0a; } /* VerbatimString */
code > span.ss { color: #049b0a; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { color: #43a8ed; font-weight: bold; } /* ControlFlow */
code > span.op { } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { font-weight: bold; } /* Preprocessor */
code > span.at { } /* Attribute */
code > span.do { color: #0066ff; font-style: italic; } /* Documentation */
code > span.an { color: #0066ff; font-weight: bold; font-style: italic; } /* Annotation */
code > span.co { color: #0066ff; font-weight: bold; font-style: italic; } /* Comment */
code > span.in { color: #0066ff; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="custom_styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href = "./">STAT 451: Causal Inference</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a><ul>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#required-references"><i class="fa fa-check"></i>Required references</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#references-for-review"><i class="fa fa-check"></i>References for review</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#further-exploration"><i class="fa fa-check"></i>Further exploration</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html"><i class="fa fa-check"></i>Schedule</a></li>
<li class="part"><span><b>I Foundational Ideas</b></span></li>
<li class="chapter" data-level="1" data-path="review-and-motivation.html"><a href="review-and-motivation.html"><i class="fa fa-check"></i><b>1</b> Review and Motivation</a><ul>
<li class="chapter" data-level="" data-path="review-and-motivation.html"><a href="review-and-motivation.html#learning-goals"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="review-and-motivation.html"><a href="review-and-motivation.html#slides"><i class="fa fa-check"></i>Slides</a></li>
<li class="chapter" data-level="" data-path="review-and-motivation.html"><a href="review-and-motivation.html#exercises"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="review-and-motivation.html"><a href="review-and-motivation.html#exercise-1-plots-and-confounders"><i class="fa fa-check"></i>Exercise 1: Plots and confounders</a></li>
<li class="chapter" data-level="" data-path="review-and-motivation.html"><a href="review-and-motivation.html#exercise-2-implications-of-confounding"><i class="fa fa-check"></i>Exercise 2: Implications of confounding</a></li>
<li class="chapter" data-level="" data-path="review-and-motivation.html"><a href="review-and-motivation.html#exercise-3-logistic-regression-models"><i class="fa fa-check"></i>Exercise 3: Logistic regression models</a></li>
<li class="chapter" data-level="" data-path="review-and-motivation.html"><a href="review-and-motivation.html#exercise-4-warming-up-to-causal-ideas"><i class="fa fa-check"></i>Exercise 4: Warming up to causal ideas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="exchangeability.html"><a href="exchangeability.html"><i class="fa fa-check"></i><b>2</b> Exchangeability</a><ul>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#pre-class-work"><i class="fa fa-check"></i>Pre-class work</a></li>
<li class="chapter" data-level="" data-path="review-and-motivation.html"><a href="review-and-motivation.html#learning-goals"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="review-and-motivation.html"><a href="review-and-motivation.html#exercises"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="study-designs-overview.html"><a href="study-designs-overview.html"><i class="fa fa-check"></i><b>3</b> Study Designs Overview</a><ul>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#pre-class-work"><i class="fa fa-check"></i>Pre-class work</a></li>
<li class="chapter" data-level="" data-path="review-and-motivation.html"><a href="review-and-motivation.html#learning-goals"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="review-and-motivation.html"><a href="review-and-motivation.html#exercises"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Causal Graphs</b></span></li>
<li class="chapter" data-level="4" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html"><i class="fa fa-check"></i><b>4</b> Causal Graphs as Statistical Models</a><ul>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#pre-class-work"><i class="fa fa-check"></i>Pre-class work</a></li>
<li class="chapter" data-level="" data-path="review-and-motivation.html"><a href="review-and-motivation.html#learning-goals"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#simulating-data-in-r"><i class="fa fa-check"></i>Simulating data in R</a><ul>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#why-simulate"><i class="fa fa-check"></i>Why simulate?</a></li>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#simulation-functions-in-r"><i class="fa fa-check"></i>Simulation functions in R</a></li>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#simulating-data-from-graphssems"><i class="fa fa-check"></i>Simulating data from graphs+SEMs</a></li>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#reproducibility"><i class="fa fa-check"></i>Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="review-and-motivation.html"><a href="review-and-motivation.html#exercises"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="causal-graphs-as-statistical-models.html"><a href="causal-graphs-as-statistical-models.html#interrupted-times-series-in-the-news"><i class="fa fa-check"></i>Interrupted times series in the news</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Homework</b></span></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html"><i class="fa fa-check"></i>Homework 1</a><ul>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#exercise-5"><i class="fa fa-check"></i>Exercise 5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html"><i class="fa fa-check"></i>Homework 2</a><ul>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#introduction"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="exchangeability.html"><a href="exchangeability.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#exercise-5"><i class="fa fa-check"></i>Exercise 5</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#exercise-6"><i class="fa fa-check"></i>Exercise 6</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#exercise-7"><i class="fa fa-check"></i>Exercise 7</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#exercise-8"><i class="fa fa-check"></i>Exercise 8</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#exercise-9"><i class="fa fa-check"></i>Exercise 9</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STAT 451: Causal Inference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="causal-graphs-as-statistical-models" class="section level1">
<h1><span class="header-section-number">Topic 4</span> Causal Graphs as Statistical Models</h1>
<div id="pre-class-work" class="section level2 unnumbered">
<h2>Pre-class work</h2>
<p>Videos/slides</p>
<ul>
<li>Introduction to Causal Graphs: <a href="https://youtu.be/vU7Vg6yaqmo">[video]</a>, <a href="https://drive.google.com/file/d/1RowV6uLm2HH3oxZnt6XuiMla-8ZvwWug/view?usp=sharing">[slides]</a></li>
<li>Causal Graphs as Statistical Models: <a href="https://youtu.be/GlgQLt6TTZo">[video]</a>, <a href="https://drive.google.com/file/d/1BfJwctdZcuRm0wCOkrSxfHzZmSf7V4Bc/view?usp=sharing">[slides]</a></li>
</ul>
<p>Checkpoint questions: <a href="https://moodle.macalester.edu/mod/quiz/view.php?id=24237">Link to Moodle checkpoint</a></p>
<ol class="example" style="list-style-type: decimal">
<li>Which of the following graph properties characterize causal graphs?
<ol style="list-style-type: lower-alpha">
<li>cyclic</li>
<li>acyclic</li>
<li>directed</li>
<li>undirected</li>
<li>complete</li>
</ol></li>
<li>For a directed graph with a node X: the parents of X are a subset of the ancestors of X.
<ol style="list-style-type: lower-alpha">
<li>TRUE</li>
<li>FALSE</li>
</ol></li>
<li><p>Apply the product decomposition rule using the Causal Markov assumption to express the joint distribution of variables in this graph: X --&gt; Y --&gt; Z</p></li>
<li><p>Apply the product decomposition rule using the Causal Markov assumption to express the joint distribution of variables in this graph: Y &lt;-- X --&gt; Z</p></li>
</ol>
<p><br><br><br><br></p>
</div>
<div id="learning-goals" class="section level2 unnumbered">
<h2>Learning Goals</h2>
<ul>
<li>PGRA1: Apply the Causal Markov assumption to express the joint distribution of data.</li>
<li>Simulate data from causal graphs under linear and logistic regression structural equation models.</li>
<li>Formulate use cases of simulation to understand causal inference concepts</li>
</ul>
<center>
<img src="images/course_flow3.svg" width="60%" height="60%">
</center>
<p><br><br><br><br></p>
</div>
<div id="simulating-data-in-r" class="section level2 unnumbered">
<h2>Simulating data in R</h2>
<p><strong>You can download a template RMarkdown file to start from <a href="template_rmds/04-graphs-models.Rmd">here</a>.</strong></p>
<div id="why-simulate" class="section level3 unnumbered">
<h3>Why simulate?</h3>
<p>Simulation is a very powerful tool for understanding statistical ideas. We can simulate (generate) data where we know the true underlying distribution, and we can then see how statistical methods perform on this data. For example:</p>
<ul>
<li>Do 95% confidence intervals really contain the true population value in 95% of samples? When is this not true?</li>
<li>Does regression work to estimate causal effects when we have conditional exchangeability?</li>
</ul>
<p><br></p>
</div>
<div id="simulation-functions-in-r" class="section level3 unnumbered">
<h3>Simulation functions in R</h3>
<p>R has functions to work with several probability distributions. For example, the following 4 functions work with the normal distribution:</p>
<ul>
<li><code>rnorm()</code>: Generate a <strong>r</strong>andom number from a normal distribution</li>
<li><code>pnorm()</code>: Tail <strong>p</strong>robability from a normal distribution</li>
<li><code>dnorm()</code>: Get <strong>d</strong>ensity value from a normal distribution</li>
<li><code>qnorm()</code>: Get a <strong>q</strong>uantile from a normal distribution</li>
</ul>
<p>There are <code>r</code>, <code>p</code>, <code>d</code>, and <code>q</code> functions for other distributions too (e.g., <code>runif()</code>, <code>rbinom()</code>.) We'll primarily use <code>r</code> functions to generate random numbers.</p>
<p><strong><code>rbinom()</code></strong>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 4 different people each flip a fair coin once</span>
<span class="kw">rbinom</span>(<span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">0.5</span>)

<span class="co"># 4 different people flip unfair coins</span>
<span class="co"># First 2 flip a coin with P(Heads) = 0.9</span>
<span class="co"># Second 2 flip a coin with P(Heads) = 0.2</span>
<span class="kw">rbinom</span>(<span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.9</span>, <span class="fl">0.9</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>))

<span class="co"># Write a command with rbinom() so that the result will definitively be 1,0,1</span></code></pre></div>
<p><strong><code>rnorm()</code></strong>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 5 numbers from a normal distribution with mean 10 and SD 2</span>
<span class="kw">rnorm</span>(<span class="dv">5</span>, <span class="dt">mean =</span> <span class="dv">10</span>, <span class="dt">sd =</span> <span class="dv">2</span>)

<span class="co"># 3 numbers from 3 different normal distributions</span>
<span class="co"># Means = 10, 100, 1000. SD = 1</span>
<span class="kw">rnorm</span>(<span class="dv">3</span>, <span class="dt">mean =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>), <span class="dt">sd =</span> <span class="dv">1</span>)

<span class="co"># Write a command with rnorm() so that the result will definitively be 10,20</span></code></pre></div>
<p><br></p>
</div>
<div id="simulating-data-from-graphssems" class="section level3 unnumbered">
<h3>Simulating data from graphs+SEMs</h3>
<p>In this course, we'll simulate data that come from graphs and their corresponding structural equation models. We'll step through how to simulate data that come from this causal graph.</p>
<p><img src="causal_manual_files/figure-html/04_dag_example-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><strong>Question:</strong> Using the Causal Markov Assumption, how can we express the joint distribution of this data?</p>
<p><br></p>
<p>Consider the structural equation model (SEM) below that is associated with our causal graph:</p>
<p><span class="math display">\[
\begin{align*}
Z &amp;\sim N(\mu_Z = 40, \sigma_Z = 5) \\
A &amp;\sim \mathrm{Binomial}(n = 1, p_A) \\
p_A: &amp;\log\left(\frac{p_A}{1-p_A}\right) = -1 + 0.05Z \\
Y &amp;\sim N(\mu_Y, \sigma_Y = 1) \\
\mu_Y &amp;= 30 + 5A + 2Z
\end{align*}
\]</span></p>
<ul>
<li><span class="math inline">\(Z\)</span> is an exogenous variable that follows a normal distribution with mean 40 and standard deviation 5.</li>
<li><span class="math inline">\(A\)</span> is binary (binomial/Bernoulli) with probability of success <span class="math inline">\(p_A\)</span>
<ul>
<li><span class="math inline">\(p_A\)</span> depends on <span class="math inline">\(Z\)</span> via a logistic regression model.</li>
</ul></li>
<li><span class="math inline">\(Y\)</span> is quantitative and follows a normal distribution.
<ul>
<li>The mean <span class="math inline">\(\mu_Y\)</span> depends on <span class="math inline">\(A\)</span> and <span class="math inline">\(Z\)</span> via a linear regression model.</li>
</ul></li>
</ul>
<p><br></p>
<p>Complete the code below to simulate data that follow this structural equation model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Sample size</span>
n &lt;-<span class="st"> </span><span class="dv">10000</span>

<span class="co"># Simulate the Z variable</span>
Z &lt;-<span class="st"> </span><span class="kw">rnorm</span>(?)

<span class="co"># Simulate the A variable</span>
log_odds_A &lt;-<span class="st"> </span><span class="op">-</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.05</span><span class="op">*</span>Z
odds_A &lt;-<span class="st"> </span><span class="kw">exp</span>(log_odds_A)
p_A &lt;-<span class="st"> </span>odds_A<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>odds_A)
A &lt;-<span class="st"> </span><span class="kw">rbinom</span>(?)

<span class="co"># Simulate the Y variable</span>
mean_Y &lt;-<span class="st"> </span><span class="dv">30</span> <span class="op">+</span><span class="st"> </span>?
Y &lt;-<span class="st"> </span>?

<span class="co"># Store all simulated variables in a dataset called sim_data</span>
sim_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Z, A, Y)</code></pre></div>
<p><br></p>
</div>
<div id="reproducibility" class="section level3 unnumbered">
<h3>Reproducibility</h3>
<p>At the top of code chunks where you perform simulation, use the <code>set.seed()</code> function to ensure that when you rerun the code, you get the same results:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">451</span>)
<span class="co"># Your simulation code</span></code></pre></div>
<p><br><br><br><br></p>
</div>
</div>
<div id="exercises" class="section level2 unnumbered">
<h2>Exercises</h2>

<div class="solutions">
<strong>Solutions to these exercises are available <a href="https://moodle.macalester.edu/mod/folder/view.php?id=28899">on Moodle</a>.</strong>
</div>

<p><br></p>

<div class="community">
What's something that you enjoyed this long weekend?
</div>

<div id="exercise-1" class="section level3 unnumbered">
<h3>Exercise 1</h3>
<ol style="list-style-type: lower-alpha">
<li><p>Write the joint distribution of the data from the causal graph below using the Causal Markov Assumption. Then simulate data from the graph. You are free to choose your own structural equation model, but let <span class="math inline">\(Z\)</span>, <span class="math inline">\(W\)</span>, and <span class="math inline">\(Y\)</span> be quantitative. Let <span class="math inline">\(A\)</span> be binary. Use a sample size of 10,000 for your simulation.</p>
<p><img src="causal_manual_files/figure-html/04_ex1-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Based on the structural equation model you chose, what would you guess is the average causal effect of <span class="math inline">\(A\)</span> on <span class="math inline">\(Y\)</span>?</p></li>
<li><p>Let's consider <em>simulating interventions</em> using your SEM. If you were to force all study units to receive a certain value of treatment (either 0 or 1), how do you think the causal graph would change?</p></li>
<li><p>Modify your simulation to reflect your thoughts from part c. Incorporate the code below into your simulation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Scenario 1: Force all to be treated</span>
A_force_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, n) <span class="co"># Repeat the number 1 n times</span>
<span class="co"># Scenario 2: Force all to be treated</span>
A_force_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n) <span class="co"># Repeat the number 0 n times</span>

<span class="co"># The treated potential outcome Y^{a=1}</span>
Y1 &lt;-<span class="st"> </span>? <span class="co"># something with A_force_1</span>
<span class="co"># The untreated potential outcome Y^{a=0}</span>
Y0 &lt;-<span class="st"> </span>? <span class="co"># something with A_force_0</span>

<span class="co"># Estimate the average causal effect</span>
<span class="kw">mean</span>(?)</code></pre></div></li>
<li><p>Was your intuition from part b close to the ACE that you estimated in the simulation?</p></li>
</ol>
<p><br><br></p>
</div>
<div id="interrupted-times-series-in-the-news" class="section level3 unnumbered">
<h3>Interrupted times series in the news</h3>
<p>If you have time, discuss the Tweet below with your group.</p>
<ul>
<li>What does Liz Stuart mean by a &quot;stark effect&quot;? What might the trends look like if the effect weren't so stark?</li>
<li>What is the treatment? What evidence does this analysis provide? Is it strong evidence? Do you have any concerns?</li>
</ul>
<center>
<blockquote class="twitter-tweet">
<p lang="en" dir="ltr">
Wow this is a pretty compelling comparative interrupted time series graph. Don't usually see such a stark effect. <a href="https://t.co/VCPLwUrXby">https://t.co/VCPLwUrXby</a>
</p>
— Elizabeth Stuart (<span class="citation">@Lizstuartdc</span>) <a href="https://twitter.com/Lizstuartdc/status/1302604052753244161?ref_src=twsrc%5Etfw">September 6, 2020</a>
</blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</center>
<p><br><br></p>

<div class="exittix">
<strong>Take a few minutes to reflect on today's ideas by filling out an <a href="https://docs.google.com/forms/d/e/1FAIpQLScHlTYLjpItT3XjktsBtJl--CqQ86WnoQS_tWmj8KHoSEzgig/viewform?usp=sf_link">exit ticket</a>.</strong>
</div>


</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="study-designs-overview.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="homework-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
